!function(e,t){"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports&&(exports=module.exports=t(e,exports)):"function"==typeof define&&define.amd?define(["exports"],function(r){e.Lockr=t(e,r)}):e.Lockr=t(e,{})}(this,function(e,t){"use strict";return Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,r=Number(arguments[1])||0;for(r=0>r?Math.ceil(r):Math.floor(r),0>r&&(r+=t);t>r;r++)if(r in this&&this[r]===e)return r;return-1}),t.prefix="",t.expires=new Date("2099").getTime(),t._getPrefixedKey=function(e,t){return t=t||{},t.noPrefix?e:this.prefix+e},t._getExpir=function(e){return e=e||{},e.expires?(new Date).getTime()+60*e.expires*1e3:this.expires},t.set=function(e,t,r){var n=this._getPrefixedKey(e,r),o=this._getExpir(r);try{localStorage.setItem(n,JSON.stringify({data:t,timestamp:o}))}catch(i){console&&console.warn("Lockr didn't successfully save the '{"+e+": "+t+"}' pair, because the localStorage is full.")}},t.get=function(e,t,r){var n,o=this._getPrefixedKey(e,r);try{n=JSON.parse(localStorage.getItem(o)),n.timestamp||(n.timestamp=this._getExpir(r))}catch(i){n=localStorage[o]?{data:localStorage.getItem(o),timestamp:this._getExpir(r)}:null}return null===n?t:"object"==typeof n&&"undefined"!=typeof n.data&&(new Date).getTime()<n.timestamp?n.data:t},t.sadd=function(e,r,n){var o,i=this._getPrefixedKey(e,n),a=t.smembers(e);if(a.indexOf(r)>-1)return null;try{a.push(r),o=JSON.stringify({data:a}),localStorage.setItem(i,o)}catch(s){console.log(s),console&&console.warn("Lockr didn't successfully add the "+r+" to "+e+" set, because the localStorage is full.")}},t.smembers=function(e,t){var r,n=this._getPrefixedKey(e,t);try{r=JSON.parse(localStorage.getItem(n))}catch(o){r=null}return null===r?[]:r.data||[]},t.sismember=function(e,r,n){this._getPrefixedKey(e,n);return t.smembers(e).indexOf(r)>-1},t.keys=function(){var e=[],r=Object.keys(localStorage);return 0===t.prefix.length?r:(r.forEach(function(r){-1!==r.indexOf(t.prefix)&&e.push(r.replace(t.prefix,""))}),e)},t.getAll=function(){var e=t.keys();return e.map(function(e){return t.get(e)})},t.srem=function(e,r,n){var o,i,a=this._getPrefixedKey(e,n),s=t.smembers(e,r);i=s.indexOf(r),i>-1&&s.splice(i,1),o=JSON.stringify({data:s});try{localStorage.setItem(a,o)}catch(c){console&&console.warn("Lockr couldn't remove the "+r+" from the set "+e)}},t.rm=function(e){localStorage.removeItem(e)},t.flush=function(){t.prefix.length?t.keys().forEach(function(e){localStorage.removeItem(t._getPrefixedKey(e))}):localStorage.clear()},t});